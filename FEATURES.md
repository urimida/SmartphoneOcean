# 디지털 오션 기능 상세 정리

## 📋 목차
1. [핵심 컨셉](#핵심-컨셉)
2. [동물과 콘텐츠 매핑](#동물과-콘텐츠-매핑)
3. [사용자 인터랙션](#사용자-인터랙션)
4. [감정 인식 및 후광 시스템](#감정-인식-및-후광-시스템)
5. [탐사 일지 시스템](#탐사-일지-시스템)
6. [시각적 효과](#시각적-효과)
7. [UI/UX 기능](#uiux-기능)
8. [성능 최적화](#성능-최적화)

---

## 핵심 컨셉

### 디지털 오션의 의미
- **메타포**: 사람들이 휴대폰에 빠져 헤매는 현실을 바닷 속을 헤매는 것으로 표현
- **상징성**: 각 동물은 특정 디지털 콘텐츠를 상징하며, 사용자가 이들을 만나며 자신의 디지털 행동을 되돌아볼 수 있음
- **자유로운 탐험**: 사용자는 바닷 속을 자유롭게 헤엄치며 다양한 생명체들을 만나고 상호작용할 수 있음

---

## 동물과 콘텐츠 매핑

### 1. 채팅 해파리 (Jellyfish)
- **상징 콘텐츠**: 채팅 앱 대화 기록
- **데이터 소스**: `jellyfishes.json`
- **데이터 구조**:
  - `sender`: 발신자 이름
  - `date`: 날짜 및 시간
  - `content`: 채팅 내용
- **특징**:
  - 해파리 형태로 부드럽게 떠다님
  - 촉수가 파도처럼 흔들리는 애니메이션
  - 영롱한 색상 (시안/하늘색 계열)
  - 이동 시 뒤쪽에 기포 생성
- **상호작용**:
  - 다이버가 25픽셀 이내 접근 시 모달 표시
  - "자세히 보기" 선택 시 텍스트로 구성된 해파리 형태로 변환
  - 텍스트는 채팅 내용으로 구성됨
  - 호버 시 핵심 문장이 팡팡 효과로 표시

### 2. 배달 해마 (Seahorse)
- **상징 콘텐츠**: 배달 앱 주문 기록
- **데이터 소스**: `deliveries.json`
- **데이터 구조**:
  - `storeName`: 가게 이름
  - `orderItems`: 주문 항목 배열
  - `totalPrice`: 총 가격
  - `reviewEvent`: 리뷰 이벤트 여부
  - `reviewMessage`: 리뷰 메시지
- **특징**:
  - 해마 형태로 수직으로 헤엄침
  - 반짝이는 효과 (sparkles)
  - 바다 테마에 맞춘 색상 필터 적용
  - 각 개체마다 살짝 다른 색감
- **상호작용**:
  - 접근 시 배달 정보 모달 표시
  - 텍스트 상세 모드에서 주문 내역이 해마 형태로 표시
  - 호버 시 가게명, 주문 항목 등이 팡팡 효과로 표시

### 3. 숏폼 고래 (Whale)
- **상징 콘텐츠**: 숏폼 동영상 시청 기록
- **데이터 소스**: `shorts.json`
- **데이터 구조**:
  - `summary`: 동영상 요약
  - `comments`: 댓글 배열
- **특징**:
  - 고래 형태로 느리게 헤엄침
  - 몸체 내부에 반짝이는 효과
  - 살짝 대각선으로 헤엄치는 애니메이션
  - 크기가 10~13 사이로 다양함
- **상호작용**:
  - 접근 시 숏폼 정보 모달 표시
  - 텍스트 상세 모드에서 요약과 댓글이 고래 형태로 표시
  - 호버 시 핵심 문장이 팡팡 효과로 표시

### 4. 쇼핑 물고기 (Fish)
- **상징 콘텐츠**: 온라인 쇼핑 기록
- **데이터 소스**: `shoppings.json`
- **데이터 구조**:
  - `storeName`: 쇼핑몰 이름
  - `productName`: 상품명
  - `price`: 가격
  - `cartCount`: 장바구니 개수
  - `wishlistCount`: 찜 개수
  - `searchTime`: 탐색 시간 (분)
  - `category`: 카테고리
- **특징**:
  - 떼지어 움직이는 느낌 (유혹하듯)
  - 플랑크톤 반짝임 효과 (찜 개수에 따라 밀도 조절)
  - 장바구니 수에 따라 태그 무리 크기 조절
  - 탐색 시간에 따라 떼 행동 증가
- **상호작용**:
  - 접근 시 쇼핑 정보 모달 표시
  - 텍스트 상세 모드에서 상품 정보가 물고기 형태로 표시
  - 호버 시 상품명, 가격 등이 팡팡 효과로 표시

### 5. 웹소설 미니 물고기 (MiniFish)
- **상징 콘텐츠**: 웹소설 읽기 기록
- **데이터 소스**: `novels.json`
- **데이터 구조**:
  - `title`: 소설 제목
  - `author`: 작가명
  - `genre`: 장르
  - `viewCount`: 조회수
  - `likeCount`: 좋아요 수
  - `readTime`: 읽은 시간 (분)
  - `platform`: 플랫폼
- **특징**:
  - 일반 물고기보다 작은 크기 (0.5배)
  - 플랑크톤 반짝임 효과
  - 조회수에 따라 크기 조절
  - 읽은 시간에 따라 떼 행동 증가
- **상호작용**:
  - 접근 시 웹소설 정보 모달 표시
  - 텍스트 상세 모드에서 소설 정보가 미니 물고기 형태로 표시
  - 호버 시 제목, 작가명 등이 팡팡 효과로 표시

### 6. 하늘의 새 (Bird)
- **상징 콘텐츠**: 없음 (장식용)
- **특징**:
  - 하늘 위를 천천히 날아다님
  - V자 형태의 픽셀 아트
  - 좌우로 이동하며 화면 밖으로 나가면 재생성
  - 2~5마리 랜덤 생성

---

## 사용자 인터랙션

### 다이버 (Swimmer) 제어

#### 1. 키보드 입력
- **방향키**: 좌우상하 이동
  - `LEFT_ARROW`: 왼쪽 이동
  - `RIGHT_ARROW`: 오른쪽 이동
  - `UP_ARROW`: 위로 이동
  - `DOWN_ARROW`: 아래로 이동
- **속도**: `speed = 0.08` (전체 이동 속도 0.8배)
- **감속**: `friction = 0.9` (관성 효과)

#### 2. 손 인식 제어 (Hand Recognition)
- **기술**: ml5.js HandPose (MediaPipe 기반)
- **활성화**: `F` 키로 토글
- **캘리브레이션**: `C` 키로 현재 손 위치를 중심으로 설정
- **조이스틱 방식**:
  - 손바닥 중심을 기준으로 조이스틱 벡터 계산
  - 데드존: `JOY_DEADZONE = 0.08`
  - 스무딩: `JOY_SMOOTH = 0.25`
  - 키보드 입력이 없을 때만 손 제어 활성화
- **제스처 인식**:
  - **손 흔들기 (Wave)**: 좌우 빠른 반전 → 모달 취소
  - **주먹 (Fist)**: 손가락 퍼짐이 작을 때 → 모달 확인
- **성능 최적화**:
  - 비디오 해상도: 160x120
  - 감지 간격: 150ms (초당 약 6~7번)
  - 이벤트 기반 방식 우선 사용

#### 3. 다이버 애니메이션
- **이미지 기반**: 4가지 방향 이미지 사용
  - `side1.png`, `side2.png`, `side3.png`: 좌우 이동
  - `up.png`: 위아래 이동 및 정지
- **방향 전환**:
  - 좌우 이동 시: side1, side2, side3을 번갈아가며 사용
  - 위아래 이동 시: up 이미지 사용 (반전 가능)
  - 정지 시: up 이미지에서 좌우 반전하며 제자리 헤엄
- **크기 조절**:
  - 좌우 이동: 1.4배 확대
  - 위아래 이동: 0.8배 축소
  - 부드러운 보간으로 전환
- **몸 각도**: 이동 방향을 따라 회전
- **팔/다리 젓기**: 이동 속도에 따라 애니메이션 속도 조절

### 생명체 상호작용

#### 1. 접근 감지
- **거리**: `INTERACTION_DISTANCE = 25` 픽셀
- **조건**: 
  - 다이버가 생명체 25픽셀 이내 접근
  - 현재 모달이 없을 때
  - 생명체가 dismissed 상태가 아닐 때
  - 같은 생명체에서 바로 다시 열리지 않도록 방지

#### 2. 모달 시스템
- **1단계 - 상호작용 모달**:
  - 생명체 종류에 따른 메시지 표시
  - "자세히 보시겠습니까?" / "그냥 지나치기" 버튼
  - 엔터키 또는 제스처로 확인 가능
- **2단계 - 텍스트 상세 모드**:
  - "자세히 보기" 선택 시 활성화
  - 생명체가 텍스트로 구성된 형태로 변환
  - 배경 블러 효과 적용
  - 텍스트 크기 조절 슬라이더 제공
  - 호버 시 핵심 문장 팡팡 효과
  - "클릭해서 닫기" 버튼으로 종료

#### 3. 키워드 팡팡 효과 (PopupKeywordManager)
- **동작 방식**:
  - 텍스트 상세 모드에서 마우스 호버 시 활성화
  - 0.3초 간격으로 키워드 생성
  - 마우스 위치 근처에서 팡팡 효과로 표시
  - 0.8초 팝업 애니메이션 + 4초 페이드아웃
- **표시 내용**:
  - 해파리: 발신자, 채팅 내용
  - 해마: 가게명, 주문 항목, 리뷰 메시지
  - 고래: 요약, 댓글
  - 물고기: 상품명, 가격, 카테고리
  - 미니 물고기: 제목, 작가명, 장르

---

## 감정 인식 및 후광 시스템

### 감정 인식 (표정 읽기)
- **기술**: Face API (ml5.js 또는 face-api.js)
- **변수**:
  - `faceApi`: Face API 인스턴스
  - `currentEmotion`: 현재 감정 ('happy', 'sad', 'angry', 'surprised', 'neutral')
  - `emotionConfidence`: 감정 신뢰도 (0~1)
- **상태**: 현재 코드에 변수 선언만 있고 실제 구현은 미완성 상태

### 후광 색상 변경
- **위치**: Swimmer 클래스의 `draw()` 메서드
- **함수**: `getEmotionHaloColor()` (전역 함수, 미구현)
- **동작 방식**:
  - 감정에 따라 후광 색상이 변경됨
  - 기본 색상(흰색/노란색)과 감정 색상을 그라데이션으로 혼합
  - 바깥쪽으로 갈수록 감정 색상이 더 강하게 반영 (최대 60%)
- **예상 감정 색상**:
  - `happy`: 밝은 노란색/주황색
  - `sad`: 파란색/회색
  - `angry`: 빨간색
  - `surprised`: 보라색/핑크색
  - `neutral`: 기본 흰색/노란색

### 감정 누적 및 리포트 반영
- **상태**: 미구현
- **예상 기능**:
  - 각 감정의 지속 시간 및 빈도 추적
  - 탐사 일지에 감정 통계 포함
  - 감정 변화 그래프 또는 시각화

---

## 탐사 일지 시스템

### 탐사 일지 버튼
- **위치**: 화면 우하단
- **이미지**: `note.png`
- **크기**: 60 * 2.5 = 150픽셀
- **효과**:
  - 내용이 추가되면 빛이 이동하는 효과 (`triggerNoteGlow()`)
  - 노트 주위에 후광 효과 (상시 은은한 후광)
  - 클릭 시 확인 모달 표시

### 탐사 일지 화면 (수첩)

#### 페이지 구성
1. **1페이지 - 탐사 일지 소개**
   - 디지털 오션에서 만난 생명체들 소개
   - 각 동물의 의미 설명
   - 일지 사용 안내

2. **2페이지 - 탐사 통계**
   - 만난 생명체 수: 각 종류별로 dismissed된 개체 수
   - 수집한 기록: 종류별 기록 개수
   - 탐사 시간: 경과 시간 (분/초)
   - 이동 거리: 총 이동 거리 (픽셀 단위)

3. **3페이지 - 탐사 완료**
   - 탐사 완료 메시지
   - 다시 탐사할 수 있다는 안내
   - 리셋 버튼 (게임 재시작)

#### UI 요소
- **노트북 스타일**: 베이지색 배경, 왼쪽 나선 바인더
- **줄 간격선**: 노트북 느낌의 가로선
- **페이지 번호**: 하단 중앙에 "1 / 3" 형식
- **이전/다음 버튼**: 레몬색 배경, 차콜색 글자
- **리셋 버튼**: 3페이지에서만 표시, 청록색
- **닫기 버튼**: 우상단 X 버튼

---

## 시각적 효과

### 배경 시스템

#### 바다 테마 (11가지)
1. **기본 파란 바다**: 클래식 블루
2. **황금빛 바다**: 노란빛, 따뜻한 일몰
3. **에메랄드 바다**: 초록빛, 열대 바다
4. **일몰 바다**: 붉은빛, 따뜻한 톤
5. **청록 바다**: 터키시 블루
6. **보라빛 바다**: 신비로운 톤
7. **민트 바다**: 연한 초록빛
8. **코랄 바다**: 핑크-오렌지 톤
9. **깊은 바다**: 딥 블루
10. **틸 바다**: 청록-녹색 톤
11. **핑크빛 바다**: 로맨틱한 핑크 톤

#### 배경 구성 요소
- **하늘**:
  - 그라디언트 (위에서 아래로)
  - 구름 (noise 기반 자연스러운 패턴)
  - 별 (어두운 하늘에만)
  - 해 (밝은 하늘에만)
- **바다**:
  - 다단계 그라디언트 (수면 → 깊은 바다)
  - 수평 방향 물결 결
  - 수중 반짝임 (Caustics) - 돌 위에만
  - 양쪽 암벽 (noise 기반)
  - 바닥 돌/흙 패턴
- **물결 왜곡**: 바다 부분만 물결 효과 적용

### 생명체 시각 효과

#### 해파리
- 돔 부분: 영롱한 그라데이션 (시안 → 하늘색 → 흰색)
- 프린지: 아래쪽 프린지 패턴
- 촉수: 파도처럼 흔들리는 애니메이션
- 기포: 이동 시 뒤쪽에 생성

#### 해마
- 반짝임 효과 (sparkles)
- 부드러운 움직임 (파도 효과)
- 바다 테마에 맞춘 색상 필터

#### 고래
- 몸체 내부 반짝임 효과
- 살짝 대각선으로 헤엄침
- 크기 다양화

#### 물고기/미니 물고기
- 플랑크톤 반짝임 효과
- 떼지어 움직이는 느낌
- 데이터에 따른 효과 밀도 조절

#### 새
- V자 형태 픽셀 아트
- 하늘 위를 천천히 이동

### 버블 시스템
- **생성 조건**:
  - 다이버 이동 시 (확률: `BUBBLE_SPAWN_PROB_SWIM = 0.3`)
  - 마우스 이동 시 (확률: `BUBBLE_SPAWN_PROB_MOUSE = 0.2`)
  - 생명체 이동 시 (각 생명체마다 다른 빈도)
- **특징**:
  - 위로 떠오름
  - 좌우로 흔들림 (wobble)
  - 투명도 다양화
  - 최대 개수 제한: `MAX_BUBBLES = 100`

### 카메라 시스템
- **따라가기**: 다이버를 중심으로 카메라가 부드럽게 따라감
- **수직 이동 최적화**: 수직 이동 시 카메라가 더 빠르게 반응
- **범위 제한**: 배경 높이를 넘지 않도록 제한
- **하늘 확장**: 하늘을 더 많이 보이도록 위쪽 공간 확장

---

## UI/UX 기능

### 프롤로그
- **표시**: 게임 시작 시 자동 표시
- **단계**: 3단계 메시지
  1. "당신은 디지털 오션에 빠졌습니다."
  2. "이 세상을 자유롭게 즐기세요."
  3. "충분히 즐겼다면, AI가 분석한 해양 탐사 일지로 당신의 여정을 확인하세요."
- **조작**: "다음" 버튼으로 진행

### 해양 분위기 선택 UI
- **위치**: 화면 왼쪽 위
- **표시 내용**:
  - 현재 선택된 테마 이름
  - 컬러 스와치 (상/중/하 색상 미리보기)
  - 토글 버튼 (▼/▲)
- **오버레이 모달**:
  - 모든 테마 목록 표시
  - 스크롤 가능 (마우스 휠)
  - 테마 선택 시 즉시 적용
  - 배경 다시 그리기

### 텍스트 크기 조절
- **위치**: 텍스트 상세 모드에서 닫기 버튼 위
- **슬라이더**:
  - 범위: 0.5 ~ 2.0 (50% ~ 200%)
  - 단계: 0.1
  - 드래그 가능
  - 현재 크기 퍼센트 표시

### 손 인식 디버그 화면
- **위치**: 화면 오른쪽 위
- **표시 내용**:
  - 원형 조정판 (조이스틱 시각화)
  - 손 위치를 빛으로 표시
  - 조이스틱 값 디버그 정보
  - 안내 텍스트
- **카메라 미리보기**: 투명도 0%로 숨김 처리 (기능은 유지)

### 모달 스타일
- **공통 스타일**:
  - 코너 반경: `UI_MODAL_RADIUS = 10`
  - 배경 알파: `UI_MODAL_BG_ALPHA = 240`
  - 어두운 배경 오버레이
- **버튼**:
  - 확인 버튼: 청록색 (#00D0FF)
  - 취소 버튼: 회색
  - 호버 효과

---

## 성능 최적화

### 버블 최적화
- 최대 개수 제한: 100개
- 화면 밖으로 나가면 즉시 제거
- 생성 빈도 조절

### 생명체 최적화
- 기포 생성 간격 제어 (각 생명체마다 다른 간격)
- 이동 거리 제곱으로 비교 (제곱근 계산 최소화)
- 픽셀 위치 캐싱 (텍스트 상세 모드)

### 손 인식 최적화
- 비디오 해상도: 160x120 (낮은 해상도)
- 모델 복잡도: 0 (최소)
- 감지 간격: 150ms
- 이벤트 기반 방식 우선 사용

### 렌더링 최적화
- 뷰 변환 캐시 (한 프레임당 한 번만 계산)
- 배경 버퍼 재사용
- 블러 효과는 상세 모드에서만 적용

### 텍스트 렌더링 최적화
- 픽셀 위치 한 번만 계산 후 캐싱
- 행별로 정렬하여 순차 렌더링
- 불필요한 계산 최소화

---

## 기술 스택

### 라이브러리
- **p5.js**: 그래픽 렌더링
- **ml5.js**: 머신러닝 (HandPose)
- **Matter.js**: 물리 엔진 (현재 미사용)

### 폰트
- **ThinDungGeunMo**: UI 폰트
- **Pretendard**: 웹 폰트 (HTML)

### 이미지 리소스
- 다이버: `side1.png`, `side2.png`, `side3.png`, `up.png`
- 생명체: `seahorse.png`, `whale.png`, `fish.png`, `minifish.png`
- UI: `note.png`

---

## 데이터 구조

### JSON 파일 형식

#### jellyfishes.json
```json
{
  "sender": "이름",
  "date": "YYYY-MM-DD HH:mm",
  "content": "채팅 내용"
}
```

#### deliveries.json
```json
{
  "storeName": "가게명",
  "orderItems": ["항목1", "항목2"],
  "totalPrice": 18000,
  "reviewEvent": true,
  "reviewMessage": "리뷰 메시지"
}
```

#### shorts.json
```json
{
  "summary": "동영상 요약",
  "comments": ["댓글1", "댓글2"]
}
```

#### shoppings.json
```json
{
  "storeName": "쇼핑몰명",
  "productName": "상품명",
  "price": 329000,
  "cartCount": 3,
  "wishlistCount": 12,
  "searchTime": 45,
  "category": "카테고리"
}
```

#### novels.json
```json
{
  "title": "소설 제목",
  "author": "작가명",
  "genre": "장르",
  "viewCount": 10000,
  "likeCount": 500,
  "readTime": 30,
  "platform": "플랫폼명"
}
```

---

## 향후 개선 사항

### 미구현 기능
1. **표정 인식 완전 구현**
   - Face API 초기화 및 감지 로직
   - 감정 분석 및 색상 매핑
   - `getEmotionHaloColor()` 함수 구현

2. **감정 누적 시스템**
   - 감정 지속 시간 추적
   - 감정 변화 그래프
   - 탐사 일지에 감정 통계 추가

3. **추가 기능**
   - 사운드 효과
   - 더 많은 바다 테마
   - 생명체 다양화
   - 모바일 최적화

---

## 사용 방법

### 시작하기
1. `index.html` 파일을 브라우저에서 열기
2. 프롤로그를 읽고 "다음" 버튼 클릭
3. 바닷 속을 자유롭게 헤엄치기

### 조작법
- **키보드**: 방향키로 이동
- **손 인식**: `F` 키로 활성화, `C` 키로 캘리브레이션
- **마우스**: 모달 클릭, 텍스트 크기 조절
- **제스처**: 손 흔들기(취소), 주먹(확인)

### 탐사 일지 확인
1. 우하단 노트 아이콘 클릭
2. 확인 모달에서 "예" 선택
3. 3페이지까지 탐색
4. 통계 확인 후 리셋 가능

---

## 라이선스 및 크레딧

- 프로젝트: 디지털 오션
- 기술: p5.js, ml5.js
- 폰트: ThinDungGeunMo, Pretendard

---

*이 문서는 프로젝트의 모든 기능을 상세히 정리한 것입니다. 추가 기능이나 변경 사항이 있으면 이 문서를 업데이트해주세요.*






